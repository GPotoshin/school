/*
 * =====================================================================================
 *
 *       Filename:  main.c
 *
 *    Description:  my ls
 *
 *        Version:  1.0
 *        Created:  09/17/2021 10:53:45
 *       Revision:  none
 *       Compiler:  clang
 *
 *         Author:  George Potoshin (GP), 
 *   Organization:  
 *
 * =====================================================================================
 */
#include "myls.h"



int main(int argc, char* argv[]){

	int flagsCounter = 0;
	int objCounter = 0;
	int numberOfOptions = 10;
	const char* objList[] = malloc(numberOfOptions*sizeof(char*);
	char* optionList = malloc(numberOfOptions*sizeof(char));
	*optionList = 0;

	struct stat *statObj = malloc(sizeof(struct stat));

	if(*optionList == NULL)
		printf("Error: optionList: failed memory allocation");

	if(*obj == NULL)
		printf("Error: obj: failed memory allocation");



	for(int i = 1, i < argc, i++){
		if(*(argv[i]) == '-'){

			for(int k = 0, *(argv[i]+k) != 0, k++){
				flagsCounter++;

				if(flagsCounter+1 > numberOfOptions){

					numberOfOptions += 10;
					char *optionList = realloc(numberOfOptions*sizeof(char));

					if(*optionList == NULL)
						printf("Error: optionList: failed memory reallocation");
				}

				*(optionList + k) = *(argv[i] + k);
				*(optionList + k+1) = 0;
			}	
		}
		else{

		}
	}
	for(int i = 0; i < objCounter; i++){

	
		check = lstat(argv[i], statObj);
		if(check == -1){
			printf("ls: %s: No such file or directory\n" argv[i]);
		}
		else{
			if(statObj.st_mode & S_IFDIR == S_IFDIR)
				putch('d');
			else
				putch('-');

			if(statObj.st_mode & S_IRUSR == S_IRUSR)
				putch('r');
			else
				putch('-');
			if(statObj.st_mode & S_IWUSR == S_IWUSR)
				putch('w');
			else
				putch('-');
			if(statObj.st_mode & S_IXUSR == S_IXUSR)
				putch('x');
			else
				putch('-');


			if(statObj.st_mode & S_IRGRP == S_IRGRP)
				putch('r');
			else
				putch('-');
			if(statObj.st_mode & S_IWGRP == S_IWGRP)
				putch('w');
			else
				putch('-');
			if(statObj.st_mode & S_IXGRP == S_IXGRP)
				putch('x');
			else
				putch('-');


			if(statObj.st_mode & S_IROTH == S_IROTH)
				putch('r');
			else
				putch('-');
			if(statObj.st_mode & S_IWOTH == S_IWOTH)
				putch('w');
			else
				putch('-');
			if(statObj.st_mode & S_IXOTH == S_IXOTH)
				putch('x');
			else
				putch('-');
		}
		
	}

	return 0;
}
